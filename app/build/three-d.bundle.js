"use strict";(self.webpackChunk_skybrush_live=self.webpackChunk_skybrush_live||[]).push([[70],{29632:(t,e,n)=>{n.r(e),n.d(e,{default:()=>Et});n(52675),n(89463),n(2259),n(45700),n(28706),n(2008),n(23792),n(89572),n(2892),n(69085),n(83851),n(81278),n(79432),n(26099),n(47764),n(98992),n(54520),n(3949),n(23500),n(62953);var r=n(5556),o=n.n(r),i=n(96540),a=n(61225),s=n(71036),l=function(t){var e=t.leftHanded,n=t.lineWidth,r=void 0===n?10:n;return i.createElement(i.Fragment,null,i.createElement("a-entity",{meshline:"lineWidth: ".concat(r,"; path: 0 0 0, 1 0 0; color: ").concat(s.Ay.axes.x)}),i.createElement("a-entity",{meshline:"lineWidth: ".concat(r,"; path: 0 0 0, 0 ").concat(e?-1:1," 0; color: ").concat(s.Ay.axes.y)}),i.createElement("a-entity",{meshline:"lineWidth: ".concat(r,"; path: 0 0 0, 0 0 1; color: ").concat(s.Ay.axes.z)}))};l.propTypes={leftHanded:o().bool,lineWidth:o().number};const c=(0,i.memo)(l);n(62062),n(81454);var u=n(97859),f=n(25508),d=n(35026),y=n(37813),h=n(26926),m=(0,f.Mz)(h.dk,function(t){var e="nwu"!==(null==t?void 0:t.type);return function(n){if((0,u.default)(n)||!t)return null;var r=t.fromLonLatAhl([n.lon,n.lat,n.ahl]);return e&&(r[1]=-r[1]),r}}),p=(0,f.Mz)(d.vT,m,function(t,e){return t.map(e)}),v=(0,f.Mz)(d.sV,m,function(t,e){return t.map(e)}),g=(n(48598),function(t){var e=t.coordinates,n=t.mixin;return e.map(function(t,e){var r="".concat(n,"-").concat(e);return t&&i.createElement("a-entity",{key:r,mixin:n,position:t.join(" ")})})});g.propTypes={coordinates:o().arrayOf(o().arrayOf(o().number)),mixin:o().string};const b=g,A=(0,a.Ng)(function(t){return{coordinates:p(t),mixin:"takeoff-marker"}},{})(b),w=(0,a.Ng)(function(t){return{coordinates:v(t),mixin:"landing-marker"}},{})(b);n(23418),n(34782),n(62010),n(27495),n(90906),n(38781);function _(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return E(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var O=function(t){var e=t.corners;if(!t.visible)return null;var n=function(t){if(0===t.length)return{center:[0,0,0],sizes:[0,0,0]};var e,n=t[0].slice(0,3),r=n.concat(),o=[0,1,2],i=_(t);try{for(i.s();!(e=i.n()).done;){var a,s=e.value,l=_(o);try{for(l.s();!(a=l.n()).done;){var c=a.value;n[c]=Math.min(n[c],s[c]),r[c]=Math.max(r[c],s[c])}}catch(t){l.e(t)}finally{l.f()}}}catch(t){i.e(t)}finally{i.f()}Math.abs(n[2])<.01&&(n[2]=-.05);var u=o.map(function(t){return(n[t]+r[t])/2}),f=o.map(function(t){return r[t]-n[t]});return{center:u,sizes:f}}(null!=e?e:[]),r=n.center,o=n.sizes;return i.createElement("a-box",{position:"".concat(r[0]," ").concat(r[1]," ").concat(r[2]),scale:"".concat(o[0]," ").concat(o[1]," ").concat(o[2]),material:"color: #fff; side: back"})};O.propTypes={corners:o().arrayOf(o().arrayOf(o().number)),visible:o().bool};const j=(0,a.Ng)(function(t){return{corners:(0,y.K3)(t),visible:(0,y._q)(t)}},{})(O);function S(t){return Object.entries(t).map(([t,e])=>`${t}: ${e}`).join("; ")}function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach(function(e){x(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function x(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=k(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==k(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var U={groundColor:"#8eb971",groundColor2:"#507a32",groundTexture:"walkernoise",groundYScale:24,playArea:1.6},R={ground:"flat",groundColor:"#333",groundColor2:"#666",groundTexture:"checkerboard"},V={"outdoor-light":P({preset:"default",fog:.2,gridColor:"#fff",skyType:"atmosphere",skyColor:"#88c"},U),"outdoor-dark":P({preset:"starry",fog:.2,gridColor:"#39d2f2",skyType:"atmosphere",skyColor:"#88c"},U),"indoor-light":P({preset:"default",fog:.2,gridColor:"#fff",skyType:"gradient",skyColor:"#eceff1",horizonColor:"#fed"},R),"indoor-dark":P({preset:"default",fog:.2,gridColor:"#888",skyType:"gradient",skyColor:"#000",horizonColor:"#222"},R)},T=function(t){var e=t.grid,n=t.type,r=void 0===n?"outdoor-dark":n,o="indoor-light"===r||"indoor-dark"===r?.5:10;return i.createElement("a-entity",{position:"0 -0.02 0",scale:"".concat(o," ").concat(o," ").concat(o)},i.createElement("a-entity",{environment:S(P(P({},V[r]||V["outdoor-dark"]),{},{grid:"string"==typeof e?e:e?"1x1":"none"}))}))};T.propTypes={grid:o().oneOfType([o().bool,o().string]),type:o().oneOf(Object.keys(V))};const I=(0,i.memo)(T);var D=n(40881);n(9868);function F(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return M(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var G=function(t){var e=t.lineWidth,n=void 0===e?5:e,r=function(t){return(Array.isArray(t)?t:[]).map(function(t){var e=F(t,3),n=e[0],r=e[1],o=e[2];return"number"!=typeof n||"number"!=typeof r||"number"!=typeof o?null:"".concat(n.toFixed(2)," ").concat(r.toFixed(2)," ").concat(o.toFixed(2))}).filter(Boolean).join(", ")}(t.points);return r?i.createElement("a-entity",{meshline:"lineWidth: ".concat(n,"; path: ").concat(r,"; color: ").concat(s.Ay.plannedTrajectory)}):null};G.propTypes={lineWidth:o().number,points:o().arrayOf(o().arrayOf(o().number))};const H=(0,i.memo)(G),N=(0,a.Ng)(function(t,e){var n=e.uavId;return{points:n?(0,D.Yd)(t,n):[]}})(H);const z=(0,a.Ng)(function(t){return{uavIds:(0,D.sj)(t)}},{})(function(t){return t.uavIds.map(function(t){return i.createElement(N,{key:t,uavId:t})})});var L=n(27232),$=(n(49982),n(81447),n(75283),n(30439)),B=n(3471),W=L.Ay.THREE.Cache;L.Ay.registerComponent("deallocate",{remove:function(){B.Ay.dispatch((0,$.S0)()),W.clear(),this.el.renderer.forceContextLoss()}});n(16034);var Y=n(38967),Z=n(87443),K=n.n(Z),q=n(65963),Q=n(86676),J=n(34808),X=n(78641),tt=n(46258),et=n(37802);function nt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return rt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var ot=L.Ay.THREE,it=(0,f.Mz)(h.dk,function(t){return function(e,n){if(null!=e&&t)return t.updateVector3FromLonLatAhl(n,e.lon,e.lat,e.ahl)}});L.Ay.registerSystem("drone-flock",{init:function(){var t=this;this.droneRadiusChanged=new Y.MiniSignal,this._onDroneRadiusChanged=this._onDroneRadiusChanged.bind(this),this._onSelectionChanged=this._onSelectionChanged.bind(this),this._selectionThunk=(0,q.p_)({getSelection:D.YZ,setSelection:Q.KY});var e=function(){return it(B.Ay.getState())};B.Ay.subscribe(K()(e)(function(e){t._updatePositionFromGPSCoordinates=e})),this._updatePositionFromGPSCoordinates=e();var n=function(){return t=B.Ay.getState(),(0,y.nk)(t)?.2:.5;var t};B.Ay.subscribe(K()(n)(this._onDroneRadiusChanged)),this._onDroneRadiusChanged(n());B.Ay.subscribe(K()(function(){return(0,D.YZ)(B.Ay.getState())})(this._onSelectionChanged)),this._updatePositionFromLocalCoordinates=function(t,e){null!=t&&(e.x=t[0],e.y=t[1],e.z=t[2])}},createNewUAVEntity:function(){var t=document.createElement("a-entity");t.setAttribute("material",{color:new ot.Color("#0088ff"),fog:!1,shader:"flat"}),t.setAttribute("position","0 0 0");var e=document.createElement("a-entity");return e.setAttribute("geometry",this._droneGeometry),e.setAttribute("glow-material",{color:new ot.Color("#0088ff"),falloff:1.5,internalRadius:5,sharpness:0}),e.setAttribute("scale","3 3 3"),t.append(e),this.updateEntityGeometry(t),t},updateEntityFromUAV:function(t,e){e.hasLocalPosition?this._updatePositionFromLocalCoordinates(e.localPosition,t.object3D.position):this._updatePositionFromGPSCoordinates&&this._updatePositionFromGPSCoordinates(e,t.object3D.position);var n=(0,tt.L4)(0|e.light),r=t.getObject3D("mesh");r&&r.material.color.setHex(n);var o=this._getGlowMeshFromEntity(t);o&&o.material&&o.material.color.setHex(n)},updateEntityGeometry:function(t){t.setAttribute("geometry",this._droneGeometry);var e=this._getGlowMeshFromEntity(t);e&&e.scale.set(this._glowScale,this._glowScale,1)},_getGlowMeshFromEntity:function(t){var e=t.childNodes[0];return e?e.getObject3D("mesh"):void 0},_onDroneRadiusChanged:function(t){this._droneRadius=t,this._droneGeometry={primitive:"sphere",radius:this._droneRadius,segmentsHeight:9,segmentsWidth:18},this._glowScale=this._droneRadius/.25,this.droneRadiusChanged.dispatch()},_onSelectionChanged:function(t,e){}}),L.Ay.registerComponent("drone-flock",{schema:{},init:function(){this.getEntityForUAVById=this.getEntityForUAVById.bind(this),this._onUAVsAdded=this._onUAVsAdded.bind(this),this._onUAVsRemoved=this._onUAVsRemoved.bind(this),this._onUAVsUpdated=this._onUAVsUpdated.bind(this),this._onUAVGeometryChanged=this._onUAVGeometryChanged.bind(this),this._uavIdToEntity={},this._signals={uavGeometryChanged:this.system.droneRadiusChanged.add(this._onUAVGeometryChanged),uavsAdded:X.Ay.uavsAdded.add(this._onUAVsAdded),uavsRemoved:X.Ay.uavsRemoved.add(this._onUAVsRemoved),uavsUpdated:X.Ay.uavsUpdated.add(this._onUAVsUpdated)},this._pendingUAVsToAdd=X.Ay.getAllUAVIds()},remove:function(){X.Ay.uavsAdded.detach(this._signals.uavsAdded),X.Ay.uavsRemoved.detach(this._signals.uavsRemoved),X.Ay.uavsUpdated.detach(this._signals.uavsUpdated),this.system.droneRadiusChanged.detach(this._signals.uavGeometryChanged)},tick:function(){if(this._pendingUAVsToAdd){var t,e=nt(this._pendingUAVsToAdd);try{for(e.s();!(t=e.n()).done;){var n=t.value,r=X.Ay.getUAVById(n);this._ensureUAVEntityExists(r)}}catch(t){e.e(t)}finally{e.f()}this._pendingUAVsToAdd=void 0}},getEntityForUAVById:function(t){return this._uavIdToEntity[t]},_ensureUAVEntityExists:function(t){var e=this,n=this._getEntityForUAV(t);if(n)return n;var r=t.id;if(r&&r.length>0){var o=this.system.createNewUAVEntity();if(o)return this.el.append(o),o.className="three-d-clickable",o.addEventListener("mouseenter",function(){B.Ay.dispatch((0,J.yo)((0,et.ZO)(r)))}),o.addEventListener("mouseleave",function(){B.Ay.dispatch((0,J.yo)(null))}),o.addEventListener("click",function(t){B.Ay.dispatch(e.system._selectionThunk(t,r))}),this._uavIdToEntity[r]=o,o}},_ensureUAVEntityDoesNotExist:function(t){var e=this._getEntityForUAV(t);e&&e.remove(),delete this._uavIdToEntity[t.id]},_getEntityForUAV:function(t){return this._uavIdToEntity[t?t.id:void 0]},_onUAVsAdded:function(t){var e,n=nt(t);try{for(n.s();!(e=n.n()).done;){var r=e.value,o=this._ensureUAVEntityExists(r);this.system.updateEntityFromUAV(o,r)}}catch(t){n.e(t)}finally{n.f()}},_onUAVsRemoved:function(t){var e,n=nt(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this._ensureUAVEntityDoesNotExist(r)}}catch(t){n.e(t)}finally{n.f()}},_onUAVsUpdated:function(t){var e,n=nt(t);try{for(n.s();!(e=n.n()).done;){var r=e.value,o=this._getEntityForUAV(r);o&&this.system.updateEntityFromUAV(o,r)}}catch(t){n.e(t)}finally{n.f()}},_onUAVGeometryChanged:function(){for(var t=0,e=Object.values(this._uavIdToEntity);t<e.length;t++){var n=e[t];this.system.updateEntityGeometry(n)}}});n(40875),n(10287),n(60825);var at=n(39437);function st(t){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},st(t)}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ct(r.key),r)}}function ct(t){var e=function(t,e){if("object"!=st(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=st(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==st(e)?e:e+""}function ut(t,e,n){return e=dt(e),function(t,e){if(e&&("object"==st(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ft()?Reflect.construct(e,n||[],dt(t).constructor):e.apply(t,n))}function ft(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ft=function(){return!!t})()}function dt(t){return dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dt(t)}function yt(t,e){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yt(t,e)}const ht=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=ut(this,e)).vertexShader="\n      varying vec3 vPosition;\n      varying vec3 vNormal;\n\n      void main() {\n        vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n        gl_Position = projectionMatrix * viewMatrix * modelPosition;\n        vec4 modelNormal = modelMatrix * vec4(normal, 0.0);\n        vPosition = modelPosition.xyz;\n        vNormal = modelNormal.xyz;\n\n      }\n    ",t.fragmentShader="\n      uniform vec3 glowColor;\n      uniform float falloff;\n      uniform float glowSharpness;\n      uniform float glowInternalRadius;\n      uniform float opacity;\n\n      varying vec3 vPosition;\n      varying vec3 vNormal;\n\n      void main()\n      {\n        // Normal\n        vec3 normal = normalize(vNormal);\n        if(!gl_FrontFacing)\n            normal *= - 1.0;\n        vec3 viewDirection = normalize(cameraPosition - vPosition);\n        float fresnel = dot(viewDirection, normal);\n        fresnel = pow(fresnel, glowInternalRadius + 0.1);\n        float falloff = smoothstep(0., falloff, fresnel);\n        float fakeGlow = fresnel;\n        fakeGlow += fresnel * glowSharpness;\n        fakeGlow *= falloff;\n        gl_FragColor = vec4(clamp(glowColor * fresnel, 0., 1.0), clamp(fakeGlow, 0., opacity));\n\n        #include <tonemapping_fragment>\n        #include <colorspace_fragment>\n      } \n      ",t.uniforms={opacity:new at.nc$(void 0!==n.opacity?n.opacity:1),glowInternalRadius:new at.nc$(void 0!==n.glowInternalRadius?n.glowInternalRadius:6),glowSharpness:new at.nc$(void 0!==n.glowSharpness?n.glowSharpness:.5),falloff:new at.nc$(void 0!==n.falloff?n.falloff:.1),glowColor:new at.nc$(void 0!==n.glowColor?new at.Q1f(n.glowColor):new at.Q1f("#00d5ff"))},t.setValues(n),t.depthTest=void 0!==n.depthTest&&n.depthTest,t.blending=void 0!==n.blendMode?n.blendMode:at.EZo,t.transparent=!0,t.side=void 0!==n.side?n.side:at.$EB,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yt(t,e)}(e,t),n=e,(r=[{key:"color",get:function(){return this.uniforms.glowColor.value},set:function(t){this.uniforms.glowColor.value.copy(t)}},{key:"falloff",get:function(){return this.uniforms.falloff.value},set:function(t){this.uniforms.falloff.value=t}},{key:"internalRadius",get:function(){return this.uniforms.glowInternalRadius.value},set:function(t){this.uniforms.glowInternalRadius.value=t}},{key:"sharpness",get:function(){return this.uniforms.glowSharpness.value},set:function(t){this.uniforms.glowSharpness.value=t}}])&&lt(n.prototype,r),o&&lt(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o}(at.BKk);L.Ay.registerComponent("glow-material",{schema:{color:{type:"color",is:"uniform",default:"#0080ff"},falloff:{type:"number",is:"uniform",default:.1},internalRadius:{type:"number",is:"uniform",default:6},sharpness:{type:"number",is:"uniform",default:1},opacity:{type:"number",is:"uniform",default:1}},init:function(){var t=this;this.material=new ht(this._getMaterialProperties()),this.el.addEventListener("loaded",function(){var e=t.el.getObject3D("mesh");e&&(e.material=t.material)})},update:function(){var t;null===(t=this.material)||void 0===t||t.setValues(this._getMaterialProperties())},_getMaterialProperties:function(){var t=this.data;return{color:t.color,falloff:t.falloff,internalRadius:t.internalRadius,sharpness:t.sharpness,opacity:t.opacity}}});n(3362),n(41795);L.Ay.registerComponent("sync-pose-with-store",{schema:{interval:{type:"number",default:1e3}},init:function(){this._intervalHandle=void 0,this._synchronize=this._synchronize.bind(this);var t=B.Ay.getState().threeD.camera,e=t.position,n=t.rotation;if(e&&Array.isArray(e)&&this.el.object3D.position.fromArray(e),n&&Array.isArray(n)&&(this.el.object3D.rotation.fromArray(n),this.el.components["look-controls"])){var r=this.el.components["look-controls"],o=r.pitchObject,i=r.yawObject;o.rotation.x=this.el.object3D.rotation.x,i.rotation.y=this.el.object3D.rotation.y}this._lastPosition=this.el.object3D.position.clone(),this._lastRotation=this.el.object3D.rotation.clone()},update:function(t){void 0!==this._intervalHandle&&t.interval===this.data.interval||this._setupIntervalCallback()},remove:function(){this._intervalHandle&&(clearInterval(this._intervalHandle),this._intervalHandle=void 0)},_synchronize:function(){var t=this.el.object3D,e=t.position,n=t.rotation;this._lastPosition.equals(e)&&this._lastRotation.equals(n)||(this._lastPosition.copy(e),this._lastRotation.copy(n),B.Ay.dispatch((0,$.$9)({position:e.toArray(),rotation:n.toArray()})))},_setupIntervalCallback:function(){this._intervalHandle&&(clearInterval(this._intervalHandle),this._intervalHandle=void 0),this.data.interval&&this.data.interval>0&&(this._intervalHandle=setInterval(this._synchronize,this.data.interval))}}),L.Ay.registerPrimitive("a-drone-flock",{defaultComponents:{"drone-flock":{}},mappings:{template:"drone-flock.template"}});var mt=n(47530);function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function vt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?vt(Object(n),!0).forEach(function(e){bt(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function bt(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=pt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pt(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function At(){return At=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},At.apply(null,arguments)}var wt=function(t){var e=(0,mt.Wb)(t);return"auto"===e?(0,y.nk)(t)?"indoor":"outdoor":e},_t=i.forwardRef(function(t,e){var n=t.cameraRef,r=t.grid,o=t.isCoordinateSystemLeftHanded,a=t.lighting,l=t.navigation,u=t.sceneId,f=t.scenery,d=t.showAxes,y=t.showHomePositions,h=t.showLandingPositions,m=t.showStatistics,p=t.showTrajectoriesOfSelection,v={"advanced-camera-controls":S({acceptsKeyboardEvent:"notEditable",embedded:!0,fly:l&&"fly"===l.mode,minAltitude:.5,reverseMouseDrag:!0}),"look-controls":S({enabled:!1}),"wasd-controls":S({enabled:!1})},g={};return m&&(g.stats="true"),i.createElement("a-scene",At({key:u,ref:e,deallocate:!0,embedded:"true","keyboard-shortcuts":"enterVR: false","loading-screen":"backgroundColor: #424242; dotsColor: #888",renderer:"antialias: false; colorManagement: true; physicallyCorrectLights: true","xr-mode-ui":"enabled: false","device-orientation-permission-ui":"enabled: false",tabIndex:-1,class:"react-hotkeys-ignore no-focus-ring"},g),i.createElement("a-assets",null,i.createElement("a-mixin",{id:"takeoff-marker",geometry:"primitive: triangle; vertexA: 1 0 0; vertexB: -0.5 0.866 0; vertexC: -0.5 -0.866 0",material:"color: ".concat(s.Ay.markers.takeoff,"; shader: flat; side: double")}),i.createElement("a-mixin",{id:"landing-marker",geometry:"primitive: triangle; vertexA: -1 0 0; vertexB: 0.5 -0.866 0; vertexC: 0.5 0.866 0",material:"color: ".concat(s.Ay.markers.landing,"; shader: flat; side: double")})),i.createElement("a-camera",At({ref:n,"sync-pose-with-store":"",id:"three-d-camera"},v),i.createElement("a-entity",{cursor:"rayOrigin: mouse",raycaster:"objects: .three-d-clickable; interval: 100"})),i.createElement("a-entity",{rotation:"-90 0 90"},d&&i.createElement(c,{leftHanded:o,length:10,lineWidth:10}),y&&i.createElement(A,null),h&&i.createElement(w,null),p&&i.createElement(z,null),i.createElement("a-drone-flock",null),i.createElement(j,null)),i.createElement(I,{type:"".concat(f,"-").concat(a),grid:r}))});_t.propTypes={cameraRef:o().any,grid:o().string,isCoordinateSystemLeftHanded:o().bool,lighting:o().oneOf(["dark","light"]),navigation:o().shape({mode:o().oneOf(["walk","fly"]),parameters:o().object}),sceneId:o().number,scenery:o().oneOf(["outdoor","indoor"]),showAxes:o().bool,showHomePositions:o().bool,showLandingPositions:o().bool,showStatistics:o().bool,showTrajectoriesOfSelection:o().bool};const Et=(0,a.Ng)(function(t){return gt(gt(gt({isCoordinateSystemLeftHanded:(0,h.Z9)(t)},t.settings.threeD),t.threeD),{},{scenery:wt(t),lighting:(0,mt.bV)(t)})},{},null,{forwardRef:!0})(_t)}}]);